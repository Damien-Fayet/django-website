{% extends "avent2025/modern_base.html" %}
{% load static %}

{% block title %}{{ message }} - Calendrier de l'Avent 2025{% endblock %}

{% block extra_css %}
<style>
    .waiting-container {
        max-width: 800px;
        margin: 4rem auto;
        text-align: center;
        animation: fadeIn 0.6s ease-in;
    }

    .waiting-icon {
        font-size: 8rem;
        margin-bottom: 2rem;
        animation: bounce 2s infinite;
    }

    .waiting-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 1.5rem;
    }

    .waiting-description {
        font-size: 1.25rem;
        color: var(--text-light);
        margin-bottom: 3rem;
        line-height: 1.8;
    }

    .waiting-card {
        background: var(--card-bg);
        border-radius: var(--border-radius);
        padding: 3rem;
        box-shadow: var(--shadow-lg);
        margin-bottom: 2rem;
    }

    .waiting-actions {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
    }

    .btn-waiting {
        padding: 1rem 2.5rem;
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: var(--border-radius);
        text-decoration: none;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-primary-waiting {
        background: linear-gradient(135deg, var(--primary), var(--accent));
        color: white;
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }

    .btn-primary-waiting:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        color: white;
    }

    .btn-secondary-waiting {
        background: var(--card-bg);
        color: var(--text);
        border: 2px solid var(--border);
    }

    .btn-secondary-waiting:hover {
        background: var(--hover-bg);
        border-color: var(--primary);
        color: var(--primary);
    }

    .completion-badge {
        display: inline-block;
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 1rem 2rem;
        border-radius: 50px;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 2rem;
        box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
    }

    .info-box {
        background: rgba(99, 102, 241, 0.1);
        border-left: 4px solid var(--primary);
        padding: 1.5rem;
        border-radius: var(--border-radius);
        margin-top: 2rem;
        text-align: left;
    }

    .info-box h3 {
        color: var(--primary);
        margin-bottom: 0.5rem;
        font-size: 1.2rem;
    }

    .info-box p {
        color: var(--text-light);
        margin: 0;
    }

    /* Styles pour le compte √† rebours */
    #countdown-container {
        margin-bottom: 3rem;
    }

    .countdown-wrapper {
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1));
        border-radius: var(--border-radius-lg);
        padding: 2rem;
        box-shadow: var(--shadow-lg);
        position: relative;
        overflow: hidden;
    }

    .countdown-sparkle {
        font-size: 3rem;
        text-align: center;
        animation: sparkle 2s ease-in-out infinite;
    }

    .countdown-title-modern {
        font-size: 1.8rem;
        font-weight: 700;
        text-align: center;
        margin: 1rem 0 2rem;
        background: linear-gradient(135deg, var(--primary), var(--accent));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .countdown-emoji {
        display: inline-block;
        animation: bounce 1.5s ease-in-out infinite;
    }

    .countdown-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1.5rem;
        max-width: 600px;
        margin: 0 auto;
    }

    .countdown-card {
        background: var(--card-bg);
        border-radius: var(--border-radius);
        padding: 1.5rem 1rem;
        text-align: center;
        box-shadow: var(--shadow-md);
        transition: transform 0.3s ease;
    }

    .countdown-card:hover {
        transform: translateY(-5px);
    }

    .countdown-flip {
        perspective: 1000px;
        margin-bottom: 0.5rem;
    }

    .countdown-number {
        font-size: 3rem;
        font-weight: 900;
        color: var(--primary);
        font-variant-numeric: tabular-nums;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .countdown-label-modern {
        font-size: 0.9rem;
        color: var(--text-light);
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 600;
    }

    @keyframes sparkle {
        0%, 100% {
            transform: scale(1) rotate(0deg);
            opacity: 0.8;
        }
        50% {
            transform: scale(1.2) rotate(180deg);
            opacity: 1;
        }
    }

    @media (max-width: 768px) {
        .countdown-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .countdown-number {
            font-size: 2.5rem;
        }

        .countdown-title-modern {
            font-size: 1.3rem;
        }

        .countdown-sparkle {
            font-size: 2rem;
        }
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes bounce {
        0%, 100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-20px);
        }
    }

    @media (max-width: 768px) {
        .waiting-container {
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .waiting-icon {
            font-size: 5rem;
        }

        .waiting-title {
            font-size: 1.8rem;
        }

        .waiting-description {
            font-size: 1rem;
        }

        .waiting-card {
            padding: 2rem 1.5rem;
        }

        .btn-waiting {
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="waiting-container">
    <!-- Compte √† rebours jusqu'au 1er d√©cembre 2025 -->
    <div id="countdown-container" style="display: none;">
        <div class="countdown-wrapper">
            <div class="countdown-sparkle">‚ú®</div>
            <div class="countdown-title-modern">
                <span class="countdown-emoji">üéÑ</span>
                L'aventure commence dans...
                <span class="countdown-emoji">üéÑ</span>
            </div>
            <div class="countdown-grid">
                <div class="countdown-card">
                    <div class="countdown-flip">
                        <div class="countdown-number" id="days">00</div>
                    </div>
                    <div class="countdown-label-modern">Jours</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-flip">
                        <div class="countdown-number" id="hours">00</div>
                    </div>
                    <div class="countdown-label-modern">Heures</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-flip">
                        <div class="countdown-number" id="minutes">00</div>
                    </div>
                    <div class="countdown-label-modern">Minutes</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-flip">
                        <div class="countdown-number" id="seconds">00</div>
                    </div>
                    <div class="countdown-label-modern">Secondes</div>
                </div>
            </div>
            <div class="countdown-sparkle">‚ú®</div>
        </div>
    </div>

    <div class="waiting-card">
        {% if is_complete %}
            <div class="completion-badge">
                üéâ F√©licitations !
            </div>
        {% endif %}

        <div class="waiting-icon">
            {% if is_complete %}
                üèÜ
            {% elif content_type == '√©nigmes' or content_type == '√©nigme' %}
                üéÑ
            {% elif content_type == 'devinettes' or content_type == 'devinette' %}
                ü§î
            {% else %}
                ‚è≥
            {% endif %}
        </div>

        <h1 class="waiting-title">{{ message }}</h1>
        <p class="waiting-description">{{ description }}</p>

        <div class="waiting-actions">
            {% if show_start_button %}
                <a href="{% url 'avent2025:start_adventure' %}" class="btn-waiting btn-primary-waiting">
                    üöÄ D√©marrer l'aventure
                </a>
            {% endif %}

            <a href="{% url 'avent2025:home' %}" class="btn-waiting {% if show_start_button %}btn-secondary-waiting{% else %}btn-primary-waiting{% endif %}">
                üè† Retour √† l'accueil
            </a>

            {% if is_complete %}
                <a href="{% url 'avent2025:classement' %}" class="btn-waiting btn-primary-waiting">
                    üèÜ Voir le classement
                </a>
            {% endif %}
        </div>

        {% if not is_complete and not show_start_button %}
            <div class="info-box">
                <h3>üí° En attendant...</h3>
                <p>
                    Profitez-en pour consulter le classement, partager votre progression avec vos amis,
                    ou explorer les autres sections du site !
                </p>
            </div>
        {% endif %}
    </div>

    {% if is_complete %}
        <div class="info-box" style="text-align: center;">
            <h3>üéÅ Merci d'avoir particip√© !</h3>
            <p>
                Vous avez brillamment r√©solu toutes les √©nigmes disponibles. 
                Restez connect√© pour ne manquer aucune nouvelle √©nigme du calendrier de l'Avent 2025 !
            </p>
        </div>
    {% endif %}
</div>

<script>
    // Compte √† rebours jusqu'au 1er d√©cembre 2025 √† 00h01
    function initCountdown() {
        const countdownContainer = document.getElementById('countdown-container');
        const targetDate = new Date('2025-12-01T00:01:00').getTime();
        
        function updateCountdown() {
            const now = new Date().getTime();
            const distance = targetDate - now;
            
            // Si la date est pass√©e, masquer le compte √† rebours
            if (distance < 0) {
                if (countdownContainer) {
                    countdownContainer.style.display = 'none';
                }
                return;
            }
            
            // Afficher le compte √† rebours
            if (countdownContainer) {
                countdownContainer.style.display = 'block';
            }
            
            // Calculs
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            // Mise √† jour de l'affichage avec padding zeros
            const daysEl = document.getElementById('days');
            const hoursEl = document.getElementById('hours');
            const minutesEl = document.getElementById('minutes');
            const secondsEl = document.getElementById('seconds');
            
            if (daysEl) daysEl.textContent = String(days).padStart(2, '0');
            if (hoursEl) hoursEl.textContent = String(hours).padStart(2, '0');
            if (minutesEl) minutesEl.textContent = String(minutes).padStart(2, '0');
            if (secondsEl) secondsEl.textContent = String(seconds).padStart(2, '0');
        }
        
        // Mise √† jour initiale
        updateCountdown();
        
        // Mise √† jour toutes les secondes
        const intervalId = setInterval(updateCountdown, 1000);
        
        // Nettoyer l'intervalle quand on quitte la page
        window.addEventListener('beforeunload', () => {
            clearInterval(intervalId);
        });
    }
    
    // D√©marrer le compte √† rebours quand la page est charg√©e
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initCountdown);
    } else {
        initCountdown();
    }
</script>
{% endblock %}
